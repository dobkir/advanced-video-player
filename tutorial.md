# Reference information in Russian about how JavaScript code in this project works
## Справочная информация на русском о том, как работает код JavaScript в этом проекте

### Основные свойства и события Video API использованные в этом проекте

#### Атрибуты
- `width` и `height` — ширина и высота контейнера для проигрывания видео.<br>
- `videoWidth` и `videoHeight` — внутреннее значение ширины и высоты видео, если размеры не известны, равны 0.<br>
- `preload` — передаёт браузеру какой контент прежде всего необходимо загрузить перед воспроизведением видео.<br>
Возможные значения атрибута:<br>
`none`: указывает, что видео не должно быть предварительно загружено;<br>
`metadata`: указывает, что извлекаются только метаданные видео (например, длина);<br>
`auto`: Указывает, что весь видеофайл может быть загружен, даже если пользователь не должен его использовать;<br>
`пустая строка`: синоним автоматического значения.<br>
- `poster` — ссылка на картинку, которую можно показывать, пока видео недоступно(обычно это один из первых непустых кадров).<br>

#### Состояние сети и готовность к работе
- `src` — ссылка(url) на воспроизводимый контент.<br>
- `buffered` — буферизованные куски видео.<br>

#### Воспроизведение и контролы
- `currentTime` — текущий момент проигрывания(с.).<br>
- `duration` — длительность медиа - контента(с.).<br>
- `playbackRate` - скорость воспроизведения (нормальная - 1.0).<br>
- `paused` — находится ли воспроизведение на паузе.<br>
- `ended` — закончилось ли проигрывание.<br>
- `muted` — включение / выключение звука.<br>
- `volume` — уровень звука[0, 1].<br>
- `play()` — начать проигрывание.<br>
- `pause()` — поставить на паузу.<br>

#### События (Events)
- `oncanplay` — можно начать проигрывание.<br>
- `ontimeupdate` — изменена позиция проигрывания.<br>
- `onplay` — запущено проигрыв.<br>
- `onpause` — нажата пауза.<br>
- `onended` — воспроизведение закончилось.<br>
- `onloadeddata` - событие запускается, когда кадр в текущей позиции
 воспроизведения мультимедиа закончил загрузку; часто первый кадр (использовал здесь для вывода миниатюр кадров при наведении мыши на прогресс-бар).<br>

#### Больше информации об элементе video на [mdn web docs](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/video).<br>

#### Больше информации о Video и Audio APIs на [mdn web docs](https://developer.mozilla.org/en-US/docs/Learn/JavaScript/Client-side_web_APIs/Video_and_audio_APIs).<br>

### Генерирование миниатюр кадров видео и использование их в качестве визуальных подсказок при наведении на шкалу времени воспроизведения

В данном проекте миниатюры кадров для подсказок на временной шкале генерируются на стороне фронтенда.<br>
Как только на видеопроигрывателе срабатывает слушатель события `canplay`, запускается функция `preloadVideoThumbnails()`, которая генерирует и загружает в массив миниатюры кадров видеофайла. Для этого создаётся невидимая копия текущего проигрывателя, в котором, с использованием события `onloadeddata` последовательно,при помощи асинхронной функции, прогоняются через цикл `for` все кадры видео и сохраняются в виде изображении малого формата (здесь 120х70) в отдельный массив.<br>
Для получения миниатюр кадров видео используется Canvas API. Подробнее о возможностях Canvas API при работе с видео рассказано на сайте [mdn web docs](https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API/Manipulating_video_using_canvas).<br>
В данной версии проигрывателя миниатюры кадров видео длительностью до 120сек формируются по одной в секунду. Если видео длиной до 300сек, то одна миниатюра в 2 секунды, до 600 - одна миниатюра в 3 секунды. Если видео длиной больше 600 секунд, то шаг создания миниатюры 5 секунд. Настройки шагов создания миниатюр в переменной `videoThumbnailsInterval`.<br>
Далее получившийся массив миниатюр просто перебирается методом`forEach` в функции `updateTimelineTooltip()` и подходящая по времени миниатюра выводится во всплывающей подсказке в одном блоке с указанием времени при наведении курсора мыши на временную шкалу.
